pipeline{
    agent any


        stages {
        stage('git check-out') {
            steps {
                  checkout changelog: false, poll: false, scm: [$class: 'GitSCM', branches: [[name: '*/hansn-feature']], extensions: [], userRemoteConfigs: [[credentialsId: 'ibt', url: 'https://github.com/IBT-learning/ibt-maven.git']]]

            }
        }

        stage('Clean') {
                    steps {
                         sh 'mvn clean'

                    }
                }

        stage('Validate') {
            steps {
                 sh 'mvn validate'

            }
        }

           stage('input1'){
                        input{
                        message "should we proceed"
                        ok "Yes, proceed"
                        }
                        steps{
                        echo 'deploy pipeline'
                        }
                        }

        stage('compile') {
                    steps {
                        sh 'mvn compile'

                    }
                }

                stage('input2'){
                input{
                message "should we proceed"
                ok "Yes, proceed"
                }
                steps{
                echo 'deploy pipeline'
                }
                }

          stage('adding SonarQube scanner') {
                environment{
                     scannerHome = tool 'ibt-sonarqube';
                }
                    steps{
                    withSonarQubeEnv(credentialsId: 'SQ-student', installationName: 'IBT sonarqube') {
                      sh "$scannerHome/bin/sonar-scanner"
                    }
                   }
                  }

             stage('package') {
                     steps {
                        sh 'mvn package'

                     }
                  }
          stage('sent to fact') {
                steps {
                  withCredentials([file(credentialsId: 'admin', variable: 'setting')]) {
                      sh "mvn deploy -s $setting"
                  }
                  }
                  }

            stage('Pipeline runs?'){
                input{
                message "does the pipeline run all steps"
                ok "Yes, proceed"
                }
                steps{
                echo 'deploy pipeline'
                }
                }

        stage('CI success') {
                    steps {


                    echo 'done'
                    }
                }
        }

   }