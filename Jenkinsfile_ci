pipeline{
        agent any

       tools {
               maven 'maven_3.9.3'
           }

      stages{
      stage('Git checkout'){
        steps{
          git branch: 'feature_tojja', changelog: false, credentialsId: 'git_credentials_tojja', poll: false, url: 'https://github.com/IBT-learning/ibt-maven.git'
        }
      }
      stage('validate'){
           steps{
               withMaven( maven: 'maven_3.9.3') {
                   sh 'mvn validate'
               }
           }
      }
      stage('compile'){
          steps{
               sh 'mvn --version'
               sh 'mvn compile'
          }
      }
        stage('test'){
                steps{
                     sh 'mvn test'
                }
            }
             stage('package'){
                       steps{
                            sh 'mvn package'
                       }
                   }
                   stage('upload to Artifactory'){
                    steps{
                        withCredentials([file(credentialsId: 'mvn_settings_tojja', variable: 'mvn_settings_tojja')]) {
                            sh 'mvn deploy -s $mvn_settings_tojja'
                        }
                    }
                   }
      }
}