pipeline {
    agent any
    tools { maven 'maven_3.8' }
    stages {
        stage('Git checkout') {
            steps {
             checkout scmGit(branches: [[name: '*/official/josias']], extensions: [], userRemoteConfigs: [[credentialsId: 'jenkins-josias', url: 'https://github.com/IBT-learning/ibt-maven.git']])
           }
        }
        stage ('validate'){
            steps {
               sh 'mvn validate'
            }
        }
        stage ('compile'){
                    steps {
                       sh 'mvn compile'
                    }
        }
        stage ('test'){
                     steps {
                        sh 'mvn test'
                     }
        }
        stage ('package'){
                    steps {
                       sh 'mvn package'
                    }
        }
        stage('Deploy'){
            steps {
               withCredentials([file(credentialsId: 'maven_settings', variable: 'josias')]) {
                 sh "mvn deploy -s $josias"
               }
            }
        }
    }
}


