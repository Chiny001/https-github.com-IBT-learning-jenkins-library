 pipeline{
 agent any
  tools { maven 'maven_3.8' }
  stages{
       stage('Git checkout'){
         steps{
         checkout changelog: false, poll: false, scm: scmGit(branches: [[name: '*/feature/yannick']], extensions: [], userRemoteConfigs: [[credentialsId: 'yannick-jenkins', url: 'https://github.com/IBT-learning/ibt-maven.git']])
         }
       }
       stage('Validate') {
          steps{
          sh 'mvn validate'
          }
       }
       stage('Compile') {
                 steps{
                 sh 'mvn compile'
            }
       }
       stage('Test') {
                 steps{
                 sh 'mvn test'
            }
        }
       stage('Package') {
                 steps{
                 sh 'mvn package'
            }
       }
       stage('Deploy'){
          steps {
          withCredentials([file(credentialsId: 'mvn-setting-yannick', variable: 'maven_setting')]) {
              withMaven(maven: 'maven_3.8')
              {
              sh "mvn deploy -s $maven_setting"
          }
        }
          withCredentials([usernamePassword(credentialsId: 'yannick-jenkins', passwordVariable: 'art-password', usernameVariable: 'art-yannick')]) {
              sh 'echo $art-yannick $art-password'
          }
          }
       }
  }

 }