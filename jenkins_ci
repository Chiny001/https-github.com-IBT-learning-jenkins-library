pipeline {
agent any

stages {
    stage ('Git Checkout') {
        steps{
            checkout changelog: false, poll: false, scm: scmGit(branches: [[name: '*/feature_claudia']], extensions: [], userRemoteConfigs: [[credentialsId: 'IBT-github-claudia', url: 'https://github.com/IBT-learning/ibt-maven.git']])
        }
    }
stage ('Validate'){
    steps{
        withMaven(maven: 'maven_3.8') {
           sh 'mvn validate'
          }
       }
    }
stage ('Compile'){
       steps{
          withMaven(maven: 'maven_3.8') {
             sh 'mvn compile'
            }
          }
     }
stage ('Run Test'){
         steps{
            withMaven(maven: 'maven_3.8') {
               sh 'mvn test'
            }
         }
      }
stage('SonarQube Analysis') {
           environment{
             sonarScan = tool 'ibt-sonarqube'
             }
           steps{
           withSonarQubeEnv(credentialsId: 'student-sonar-token', installationName: 'IBT sonarqube') {
               sh "$sonarScan/bin/sonar-scanner"
            }
          }
        }
stage ('Package'){
        steps{
         withMaven(maven: 'maven_3.8') {
          sh 'mvn package'
            }
          }
        }
      }
    }
